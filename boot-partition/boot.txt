# After modifying, run ./mkscr

setenv slot 0

# MAC address (use spaces instead of colons)
# DEVICE_SPECIFIC: change this MAC address
setenv macaddr 68 27 19 ac db 26

part uuid ${devtype} ${devnum}:${bootpart} uuid
setenv bootargs earlyprintk debug root=PARTLABEL=rootfs${slot} overlaytmpfs loglevel=9 earlycon console=ttyS2,1500000 lsm=landlock,lockdown,yama,loadpin,safesetid,integrity,apparmor,bpf
setenv fdtfile rockchip/rk3399-nanopi-r4s.dtb
setenv kernel_flavor lts
setenv kernel_comp_addr_r 0x0a000000

if load ${devtype} ${devnum}:${bootpart} ${kernel_addr_r} /boot_${slot}/vmlinuz-${kernel_flavor}; then
  if load ${devtype} ${devnum}:${bootpart} ${fdt_addr_r} /boot_${slot}/dtbs-${kernel_flavor}/${fdtfile}; then
    fdt addr ${fdt_addr_r}
    fdt resize
    fdt set /ethernet@fe300000 local-mac-address "[${macaddr}]"
    if load ${devtype} ${devnum}:${bootpart} ${ramdisk_addr_r} /boot_${slot}/initramfs-${kernel_flavor}; then
      booti ${kernel_addr_r} ${ramdisk_addr_r}:${filesize} ${fdt_addr_r};
    else
      booti ${kernel_addr_r} - ${fdt_addr_r};
    fi;
  fi;
fi
