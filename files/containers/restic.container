[Unit]
Description=restic rest server
After=network.target run-media-resticbackup.mount
Requires=run-media-resticbackup.mount

[Container]
ContainerName=restic
Image=ghcr.io/m1cha/restic-rest-server:latest
Label=io.containers.autoupdate=registry
Network=none

PodmanArgs=--mount type=bind,src=/opt/container-secrets/restic,dst=/media/config,ro,idmap,relabel=shared
PodmanArgs=--mount type=bind,src=/run/media/resticbackup,dst=/media/data,rw,idmap,relabel=shared

Environment=DATA_DIRECTORY=/media/data/1200
Environment=DISABLE_AUTHENTICATION=1
Environment="OPTIONS=--tls --tls-cacert /media/config/ca.pem --tls-cert /media/config/ssl_cert.pem --tls-key /media/config/ssl_key.pem --inactivity-timeout 10m"
